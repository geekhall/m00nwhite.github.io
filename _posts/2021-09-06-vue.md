---
layout: post
title:  "Vue 笔记 3 - Ajax"
date:   2021-09-06 12:10:25 +0800
categories: vue
---
* 目录
{:toc}

# Vue 笔记 3 - Ajax

安装axios
```
npm i axios
```


## 代理

跨域：协议名、主机名、端口号三者不同时浏览器认为跨域了。

![](https://yinyang.space/img/20210906_ajax_cors.png)

### 使用nodejs搭建两个简易后台服务端：

server1.js
```js
// node src/server1.js
// http://localhost:5001/student

let express = require('express');
let app = express();
let fs = require('fs');
const log = console.log;

app.get('/student', function (request, response){
    response.writeHead(200, {'Content-Type': 'application/json'});
    log("有人访问了server1");
    response.end(JSON.stringify({
        name: 'server',
        age: 2020
    }));
});

let server = app.listen(5001, function(){
    let host = server.address().address
    let port = server.address().port
    log("有人访问了server1");
})
```

server2.js
```js
// node src/server2.js
// http://localhost:5002/car

let express = require('express');
let app = express();
let fs = require('fs');
const log = console.log;

app.get('/car', function (request, response){
    response.writeHead(200, {'Content-Type': 'application/json'});
    log("有人访问了server2");
    response.end(JSON.stringify({
        name: 'car',
        age: 2020
    }));
});

let server = app.listen(5002, function(){
    let host = server.address().address
    let port = server.address().port
    log("有人访问了server2");
})
```

然后就可以通过`node src/server1.js`和`node src/server2.js` 来启动服务器。

### 配置vuecli开启代理服务器：
修改vue的自定义配置文件`vue.config.js`
* 方式一：
  ```js
    devServer: {
        proxy: 'http://localhost:5001'
    }
  ```
* 方式二：
  ```js
    devServer: {
        proxy: {
            '/api': {
                target: '<url>',
                ws: true,
                changeOrigin: true
            },
            '/foo': {
                target: '<other_url>'
            }
        }
    }
  ```